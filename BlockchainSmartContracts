# scripts/deploy.py

from web3 import Web3
import json

# Connect to local Ethereum node
w3 = Web3(Web3.HTTPProvider('http://127.0.0.1:8545'))

# Set default account (this should be one of the accounts generated by Ganache)
w3.eth.default_account = w3.eth.accounts[0]

# Compile the smart contract using solc
compiled_sol = compile_source(open('../contracts/SimpleStorage.sol', 'r').read())
contract_interface = compiled_sol['<stdin>:SimpleStorage']

# Deploy the contract
SimpleStorage = w3.eth.contract(abi=contract_interface['abi'], bytecode=contract_interface['bin'])
tx_hash = SimpleStorage.constructor().transact()
tx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)

print(f'Contract deployed at address: {tx_receipt.contractAddress}')
